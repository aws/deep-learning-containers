# AWS Deep Learning Containers for PyTorch 2.4 Inference on EC2, ECS and EKS

[AWS Deep Learning Containers](https://aws.amazon.com/machine-learning/containers/) (DLCs) for Amazon Elastic Compute Cloud (EC2), Amazon Elastic
Container Service (ECS), and Amazon Elastic Kubernetes Service (EKS) are now available with PyTorch 2.4 and support for CUDA 12.4 on Ubuntu 22.04.

This release includes container images for inference on CPU and GPU, optimized for performance and scale on AWS. These Docker images have been tested
with EC2, ECS and EKS services, and provide stable versions of NVIDIA CUDA, cuDNN, Intel MKL, and other components. All software components in these
images are scanned for security vulnerabilities and updated or patched in accordance with AWS Security best practices. If you are looking for a DLC to
use with SageMaker, please refer to
[this documentation](https://github.com/aws/deep-learning-containers/blob/master/available_images.md#general-framework-containers-ec2-ecs-eks--sm-support).

## Release Notes

- Introduced containers for PyTorch 2.4.0 for inference supporting EC2, ECS, and EKS. For details about this release, check out our GitHub
  [release tag](https://github.com/aws/deep-learning-containers/releases/tag/v1.0-pt-ec2-2.4.0-inf-py311).
- PyTorch 2.4 offers support for python custom operator API allowing users to integrate custom kernels such as Triton kernels into torch.compile.
- Please refer to the official PyTorch 2.4 release notes [here](https://github.com/pytorch/pytorch/releases/tag/v2.4.0) for the full description of
  updates.
- Added Python 3.11 support
- Added CUDA 12.4 support
- Added Ubuntu 22.04 support
- The Dockerfile for CPU can be found
  [here](https://github.com/aws/deep-learning-containers/blob/master/pytorch/inference/docker/2.4/py3/Dockerfile.cpu), and the Dockerfile for GPU can
  be found [here](https://github.com/aws/deep-learning-containers/blob/master/pytorch/inference/docker/2.4/py3/cu124/Dockerfile.gpu).

## Security Advisory

AWS recommends that customers monitor critical security updates in the [AWS Security Bulletin](https://aws.amazon.com/security/security-bulletins/).

## Python 3.11 Support

Python 3.11 is supported in the PyTorch Inference containers.

## CPU Instance Type Support

The containers support x86_64 CPU instance types.

## GPU Instance Type Support

The containers support GPU instance types and contain the following software components for GPU support:

- CUDA 12.4.1
- cuDNN 9.1.0.70+cuda12.4
- NCCL 2.22.3+cuda12.4

## Build and Test

- Built on: c5.18xlarge
- Tested on: c5.18xlarge, g3.16xlarge, m5.16xlarge, t3.2xlarge, p3.16xlarge, p3dn.24xlarge, p4d.24xlarge, g4dn.xlarge
- Tested with [MNIST](http://yann.lecun.com/exdb/mnist/) and Resnet50/ImageNet datasets on EC2, ECS AMI (Amazon Linux AMI 2.0.20221102), and EKS AMI
  (amazon-eks-gpu-node-1.25.16-20240307)
