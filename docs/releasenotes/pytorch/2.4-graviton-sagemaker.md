# AWS Deep Learning Containers for PyTorch 2.4 Graviton on SageMaker

[AWS Deep Learning Containers](https://aws.amazon.com/machine-learning/containers/) (DLCs) for Amazon SageMaker are now available for the [Graviton](https://aws.amazon.com/ec2/graviton/) instance type with support for PyTorch 2.4.

This release includes a container image for inference on CPU, optimized for performance and scale on AWS. This Docker image was tested on SageMaker. All software components in this image are scanned for security vulnerabilities and updated or patched in accordance with AWS Security best practices.

Please refer to the [SageMaker Graviton blog](https://aws.amazon.com/blogs/machine-learning/run-machine-learning-inference-workloads-on-aws-graviton-based-instances-with-amazon-sagemaker/) and DLC [developer guide](https://docs.aws.amazon.com/dlami/latest/devguide/deep-learning-containers.html) to migrate the Deep Learning workloads to Graviton instances.

## Release Notes

- Introduced container for PyTorch 2.4 for inference supporting SageMaker services on Graviton instances. For details about this release, check out our GitHub [release tag](https://github.com/aws/deep-learning-containers/releases/tag/v1.0-pt-graviton-sagemaker-2.4.0-inf-cpu-py311).
- TorchServe version: 0.11.1
- 10/25/24: Updated TorchServe to 0.12.0 ([release tag](https://github.com/aws/deep-learning-containers/releases/tag/v1.3-pt-graviton-sagemaker-2.4.0-inf-cpu-py311))
- Please refer to the official PyTorch 2.4 release notes [here](https://github.com/pytorch/pytorch/releases/tag/v2.4.0) for framework updates.

## Performance Improvements

These DLCs continue to deliver the best performance on Graviton for BERT and RoBERTa sentiment analysis and fill mask models, making Graviton3 the most cost effective CPU platform on the AWS cloud for these models. For more information, please refer to the [Graviton PyTorch User Guide](https://github.com/aws/aws-graviton-getting-started/blob/main/machinelearning/pytorch.md).

## Security Advisory

AWS recommends that customers monitor critical security updates in the [AWS Security Bulletin](https://aws.amazon.com/security/security-bulletins/).

## Python 3.11 Support

Python 3.11 is supported in the PyTorch Graviton Inference containers.

## CPU Instance Type Support

The containers support Graviton CPU instance types supported under SageMaker.

## Build and Test

- Built on: c6g.2xlarge
- Tested on: c7g.4xlarge, c6g.4xlarge, t4g.2xlarge, r6g.2xlarge, m6g.4xlarge
- Tested with [MNIST](http://yann.lecun.com/exdb/mnist/) and Resnet50/DenseNet datasets on EC2, ECS AMI (Amazon Linux AMI 2.0.20220822 arm64) and EKS AMI (1.25.6-20230304 arm64)

## Known Issues

- None

For latest updates, please refer to the [aws/deep-learning-containers GitHub repo](https://github.com/aws/deep-learning-containers/tags).
