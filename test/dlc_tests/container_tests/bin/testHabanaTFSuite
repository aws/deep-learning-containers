#!/bin/bash

# Pytorch test suite

HOME_DIR=/test
LOG_DIR=`dirname $LOG_FILE`


mkdir -p ${HOME_DIR}/artifacts
mkdir -p ${LOG_DIR}


set -e

START=$(date +%s)

python3 gaudi_test_suite.py -tm framework -f tf 2>&1 | tee ${LOG_FILE}

RETURNVAL=$?
if [ $RETURNVAL -eq 0 ];
then
    echo "Tensorflow framework test executed successfully"
    exitcode=0
else
    echo "Tensorflow framework test terminated unsuccessfully"
    exitcode=$RETURNVAL
fi

END=$(date +%s)
DIFF=$(( END - START ))
echo Script took $(( DIFF/60 )) mins to finish >> "${LOG_FILE}"
set +e

rm -rf ${HOME_DIR}/artifacts/gaudi-test-suite

exit 0