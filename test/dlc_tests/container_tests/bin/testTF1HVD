#!/bin/bash
TOKEN=`curl --silent --show-error --retry 3 -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600"`
INSTANCE_TYPE=`curl --silent --show-error --retry 3 -H "X-aws-ec2-metadata-token: $TOKEN" http://169.254.169.254/latest/meta-data/instance-type`
if [[ $INSTANCE_TYPE == g2* ]]; then
  echo "This is g2* instance. Skipped."
  exit 0
fi

HOME_DIR=/test
BIN_DIR=${HOME_DIR}/bin
LOG_DIR=${HOME_DIR}/logs

${BIN_DIR}/testTF1HVDHelper || exit 1

echo "TF HVD tests passed!"
exit 0
